<img width="1366" height="657" alt="nessus vuln_analysis" src="https://github.com/user-attachments/assets/a71e586f-c6e6-4aa9-8fe1-8701c1b6f42c" />**I used Nikto, Nessus, and Qualys to check this website for security holes. This report shows what I found and how we can fix the problems to keep the site safe**

--------------------------

### **Tools Used**

CVE

CWE

OWASP

CVSS

In this phase, i'll be analyzing, scoring and providing solutions to the vulnerability scan which was done earlier

<img width="1366" height="657" alt="missing content header" src="https://github.com/user-attachments/assets/fd498983-0f63-4bcf-bafa-b12fe45116f9" />

<img width="1366" height="657" alt="missing header2" src="https://github.com/user-attachments/assets/2918e9d3-0ae3-415c-929b-ecf3072204f3" />

I followed linked provided by nikto for the **missing content-type header** and impact and remediation which i have highlighted earlier in the
vulnerability scan, after i followed the CWE and OWASP links provided to analyze the vulnerability and procure solution

The <sup> CWE 16 </sup>indicates that it's prohibited to be used for real-world mappings. So i will not be using it in this documentation. 
The results provided below

<img width="1358" height="566" alt="Owasp result" src="https://github.com/user-attachments/assets/097960fc-eccf-47ae-ae73-f70d00382b59" />


Since I can't analyze the CWE because of the prohibition, I mapped it to OWASP 2017-A6; **Security Misconfiguration**. This category
covers risks caused by incomplete or incorrect security settings

<img width="1366" height="657" alt="owasp" src="https://github.com/user-attachments/assets/5cf700df-bf40-4671-9862-f95b5f17d4ad" />

According to OWASP, an application is vulnerable if it lacks appropriate security hardening or has improperly configured settings.
Specifically, the server "does not send security headers or directives" to the browser as evidently shown in the nikto scan. The risk involves Clickjacking, Without
X-Frame-Options, an attacker can render the site in an invisible frame to trick users into performing unintended actions. Risk involved also include MIME-Sniffing; 
Without X-Content-Type-Options, the browser might interpret a file in a different fashion than the intended MIME type, potentially leading to script execution.

**Solution: **

To stop Clickjacking , you should add this to your Apache configuration: Header always append X-Frame-Options SAMEORIGIN

To stop MIME-Sniffing also you should add this to your Apache configuration: Header set X-Content-Type-Options "nosniff"

Use a repeatable process to ensure every server you build has these headers turned on by default

Since OWASP A6 also mentions "outdated software," the ultimate solution is to move away from the legacy Apache 2.4.7 and
Ubuntu 14.04 versions discovered by Nikto.

### Web Vulnerability: OWASP A6 - Security Misconfiguration

| Component | Information |
| :--- | :--- |
| **Tool Discovery** | Nikto v2.5.0 |
| **Weakness** | CWE-16 (Broad Configuration Category) |
| **OWASP Risk** | A6:2017 - Security Misconfiguration |
| **Technical Impact** | Susceptible to Clickjacking and MIME-type sniffing |
| **Primary Fix** | Manually set security headers in Apache configuration and update the software |

---------------------------------------------------------------

Phase 2: Analyzing the Qualys vulnerability scan and procuring a solution 

According to the Qualys scan, it provided me a CVE ID which i'll be using to perfrom the analysis in this section

<img width="1008" height="675" alt="Qualys results 3" src="https://github.com/user-attachments/assets/87412e47-4ba0-45f5-bdd0-3eca8b1d06e9" />

<img width="1365" height="630" alt="cve record" src="https://github.com/user-attachments/assets/93877046-532a-408c-ad22-0545ed14775f" />

<img width="1041" height="569" alt="cve 2" src="https://github.com/user-attachments/assets/fe777e9f-ad8b-40bf-b3cb-4b98cc3f8096" />




The CVE ID <sup>**CVE 2023-48795**</sup> explains a security flaw in the SSH protocol known as Terrapin Attack, it indicates that the vulnerability exists in the SSH transport protocol when certain extensions are used,
specifically affecting OpenSSH versions before 9.6., It allows a remote attacker to bypass "integrity checks" during the connection process
Intruders can delete or omit certain messages during the extension negotiation phase without the client or server noticing. By removing these messages, the attacker can force the connection to use weaker security features
This is essentially a "downgrade attack" where a secure connection is trickd to becoming less secure one. 

<img width="1353" height="673" alt="cwe 345" src="https://github.com/user-attachments/assets/d6a8fc35-abd9-42a1-a395-bac65b6a92ef" />

The research shows the CWE-354 is tied to the CVE 2023-48795 which identifies as Improper Validation Of integrity Check Value, this means the protocol
fails to properly validate the integrity check value(the digital seal) of messages been sent

CVE 2023-48795 CVSS is 5.9 (MEDIUM). To fix the medium vulnerabilty, the OpenSSH version needs to be patched, probably move to version 9.6
or higher, which includes strict key exchange to stop the attack and disable weak ciphers

| Source / ID | Vulnerability Name | Weakness (CWE) | CVSS Score | Recommended Solution |
| :--- | :--- | :--- | :--- | :--- |
| *Qualys Scan* | SSH Terrapin Attack | CWE-354 | *5.9 (Medium)* | Upgrade OpenSSH to v9.6+ and enable Strict Key Exchange. |
| *CVE-2023-48795* | Prefix Truncation | CWE-354 | *5.9 (Medium)* | Disable ChaCha20-Poly1305 and CBC-EtM ciphers. |
| *CWE Analysis* | Integrity Check Failure | CWE-354 | N/A | Implement protocols that verify handshake integrity. |

--------------------------------------------------

Phase 3: Nessus scan vulnerabilities analysis and recommended solution

<img width="1366" height="657" alt="nessus vuln_analysis" src="https://github.com/user-attachments/assets/85e494bf-a7e0-46e1-8acd-a624d03e5ee5" />

The most severe issue found by nessus is the server running on Ubuntu 14.04, which reached End of Life (SEoL) years ago, Canonical no longer provides
a security patches for the version, every vulnerability found in 2019 can be used to hack this server becuse the door is left permanently open. Nessus identify this as critical. CVSS score 10.0

<img width="1366" height="657" alt="nessus ssh1" src="https://github.com/user-attachments/assets/609b0348-ff0d-4aa1-84be-9d60e3135e1c" />

<img width="1366" height="657" alt="nessus ssh2" src="https://github.com/user-attachments/assets/bb4d85a1-2f13-4bf4-9d87-ae24747db307" />

<img width="1366" height="657" alt="nessuss ssh3" src="https://github.com/user-attachments/assets/a04a6dde-d648-4cd0-8f47-bec884274d92" />

The scan also indicates tat the SSH server supports CBC Mode Ciphers which is an old way of encrypting data. It also supports Weak MAC algorithms
You should edit your _etc/ssh/sshd_config_ file to disable CBC ciphers

| Severity | Plugin Name | Nessus ID | CVSS Score | Mitigation Strategy |
| :--- | :--- | :--- | :--- | :--- |
| **CRITICAL** | Canonical Ubuntu Linux SEoL (14.04.x) | 201408 | **10.0** | **Decommission/Upgrade:** Host is past End-of-Life; migrate to Ubuntu 22.04 LTS. |
| **HIGH** | SSH Terrapin Prefix Truncation | 187310 | **5.9** | **Configuration:** Enable Strict Key Exchange and upgrade OpenSSH to v9.6+. |
| **MEDIUM** | SSH Server CBC Mode Ciphers Enabled | 70658 | **4.3** | **Hardening:** Disable CBC ciphers; use CTR or GCM modes in `sshd_config`. |
| **MEDIUM** | SSH Weak Key Exchange Algorithms Enabled | 153953 | **4.3** | **Hardening:** Disable Diffie-Hellman Group 1; use Elliptic Curve (ECDH) algorithms. |
| **MEDIUM** | SSH Weak MAC Algorithms Enabled | 153954 | **2.6** | **Hardening:** Disable MD5/96-bit MACs; use `hmac-sha2-512` or `hmac-sha2-256`. |


## **Consolidated Solution**

OS Level: The server is End of Life (EOL). No amount of software patching can fully secure it. The priority is a Full System Migration

SSH Hardening: To stop the Terrapin and CBC attacks, the SSH configuration must be rewritten to only allow modern, high-integrity encryption

Web Hardening: Apache must be configured to stop "leaking" its version number and to send headers that protect users from Clickjacking


## Conclusion
This vulnerability assessment concludes that the target environment is at High Risk, primarily due to the use of an unsupported Operating System (Ubuntu 14.04) which no longer receives critical security patches. While individual configurations in SSH and Apache can be hardened to reduce the attack surface, these are temporary fixes

The presence of the Terrapin Attack (CVE-2023-48795) and Weak Cryptographic Algorithms indicates that encrypted communications are susceptible to interception and downgrade attacks. Furthermore, missing web security headers leave users vulnerable to client-side exploits

Final Recommendation: To achieve a baseline level of modern security, the immediate decommissioning of the Ubuntu 14.04 host in favor of a supported LTS (Long Term Support) distribution is mandatory. Following migration, a follow-up scan should be conducted to verify that the reported vulnerabilities have been successfully remediated
