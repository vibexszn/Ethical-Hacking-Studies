Building on the insights gained from my passive and active reconnaissance, I will now leverage this intelligence to conduct a targeted vulnerability scan. This approach ensures the scan is precisely tuned to identify exploitable weaknesses within the specific attack surface discovered

-----------------------------------------------------------

__**TOOLS USED:**__

tcpdump

Wireshark

Nikto

Nessus

Qualys

---------------------------------------
**Methodologies:**

Automated Vulnerability Scanning

Web Server Benchmarking 

--------------------------------
Phase 1: Usage of tcpdump & nikto simultaneously

I initiated a Nikto vulnerability scan while simultaneously utilizing tcpdump to capture the underlying network traffic, which was subsequently analyzed in Wireshark to observe the scanner's behavior and the server's responses

<img width="1366" height="204" alt="tcpdump" src="https://github.com/user-attachments/assets/ffaf7f5e-8b87-4e0c-bace-3911035e729e" />

_in the jpg above, i utilized tcpdump to capture raw network traffic and saved the output to niktoscan_capture1.pcap. This allows for a detailed post-scan analysis in Wireshark to validate the Nikto scan results and examine the specific request-response patterns_

<img width="1366" height="435" alt="niktoscan" src="https://github.com/user-attachments/assets/a9db5747-7ee9-420e-8881-378c8ec2ba6d" />

 _I performed a basic Nikto scan because reconnaissance identified only port 80 as open. However, had port 443 also been active, I would have enabled the -ssl flag to ensure a comprehensive vulnerability assessment across both the unencrypted and encrypted web services._ The scan found that the web server is outdated (Apache 2.4.7). It's missing important security 'headers' that protect users from getting tricked into clicking hidden buttons (Clickjacking) or running malicious files (MIME-sniffing). Also, the server tells us too much about itself, making it an easy target

**_Wireshark Analysis:_** After capturing the network traffic of the Nikto scan against scanme.nmap.org, I performed a deep-packet analysis of the _.pcap file_ using Wireshark. This allowed me to dissect the interaction between the scanner and the target, providing a clear view of the HTTP request methods used and the server's subsequent responses


<img width="1366" height="657" alt="wiresharkevidence" src="https://github.com/user-attachments/assets/1f66e302-1faa-4cb9-9834-88b05dc3e772" />

in the image png above, by using the _http.request.method == "GET" filter_, to isolate the scanner probes from background noise, revealing exactly which directories and sensitive files that were targeted for discovery. This analysis allows me to map the attacker intent by identifying _"200 OK"_ responses that confirm successful access to specific resources on the legacy Apache server.


I followed the TCP stream after filtering the packet to get the raw conversation between my machine and the web server, the result of the TCP stream are below 

<img width="1366" height="657" alt="wireshark_follow tcp stream" src="https://github.com/user-attachments/assets/74cb8c32-cbaa-42dc-906a-830f5149a218" />

_**Key findings:**_

Since the Clickjacking Lock (X-Frame-Options)is missing, an intruder can hide the website inside another site to trick people into clicking buttons they didn't mean to click.

Verification of the server identity i got in the recon stage

The Missing File-Type Lock could let an attcker trick the site into running a virus disguised as a photo. The presence of _(X-Content-Type-Options)_ stops the broser from guessing what file is it

Because HTTP (Port 80) is used and not HTTPS, anyone listening on the network can see exactly what is happening

There is no handshake or lock icon on the traffic. If a user typed a password on this site, i would see it clearly in Wireshark

Identification of the Page Content _<title> Go ahed and Scan Me!</title>_..this confirms that im directly interacting with the legitimate and authorized testing lab

Presence of Analytics and tracking, _ga('create', 'UA-11009417-1', 'auto');_ ..this means that the server is tracking visitor behavior

-----------------------------------------

While Nikto is excellent for finding web server misconfigurations and dangerous files, **Nessus and Qualys** are necessary to provide a comprehensive view of the entire infrastructure, including the operating system and network services. By using multiple scanners, i will eliminate "blind spots" caused by different signature databases and validate your findings to ensure high-accuracy results before reporting

In this phase, i'll be using nessus and qualys to perform the vulnerability which will scan and map the entire infastructure

Phase 2: After inputting my target in qualys scan, i launched the scan

<img width="1010" height="675" alt="qualys scan result" src="https://github.com/user-attachments/assets/7bdd0c9e-0a74-4ffc-b4af-1f6156c81574" />

<img width="1012" height="692" alt="qualys scan result 2" src="https://github.com/user-attachments/assets/a5cde233-e6fb-4c30-8dc7-05149ef6ed53" />

_The scan identifies it as **CVE-2023-48795** which targets the SSH transport layer protocol_

<img width="1008" height="675" alt="Qualys results 3" src="https://github.com/user-attachments/assets/65f4cca7-9f04-4871-b7eb-14967cabf7ab" />

_The automated scan identified that the OpenSSH service on Port 22 is susceptible to the Terrapin Attack. This vulnerability allows the attacker to break the integrity of the SSH extension negotiation, potentially downgrading the connection's security parameters._

_The exploit works by manipulating the SSH sequence numbers during the handshake process. It allows the attacker to "truncate" or delete specific extension negotiation messages without the client or server noticing_

_If successfully exploited, the primary result is a Security Downgrade. The attacker can force the connection to use weaker, less secure cryptographic algorithms. While it doesn't instantly grant "root" access, it significantly weakens the connection's integrity. This makes it easier for the attacker to perform further man-in-the-middle (MITM)/On-path attacks or potentially bypass certain integrity checks._

_This is especially relevant to my findings because I captured legacy SSH host keys (DSA 1024-bit) in the Nmap scan earlier, which are already considered cryptographically weak._

_My finding also correlates with the initial recon, which identified the server running an outdated OpenSSH 6.6.1p1 version on Ubuntu 14.04. The presence of legacy DSA keys further increases the risk that an attacker could successfully downgrade and compromise the session integrity_

<img width="1000" height="686" alt="Qualys results 4" src="https://github.com/user-attachments/assets/2d7637c1-b2b8-4fb7-bacf-b3e56c8225aa" />

_Beyond the Terrapin exploit that was found earlier, Port 22 is also found to support multiple deprecated cryptographic primitives, including 1024-bit Diffie-Hellman groups and legacy ciphers (ARC4/3DES). These settings represent a significant configuration flaw, as they allow an adversary to perform downgrade attacks and potentially decrypt SSH session traffic, compromising the confidentiality of the administrative channel_

_This also proves that the server isn't just "unpatched" (software versions); it is also misconfigured (security settings). I think this suggests a lack of a "Hardening Policy" for the organization's infrastructure._


<img width="1002" height="682" alt="Qualys scan 5" src="https://github.com/user-attachments/assets/290d3b0b-263c-4840-b70f-eebd85c28109"/>

The scan result for port 80 shows a critical missing defense layer. **_HTTP Security Headers Not Detected_**. While this is not a direct exploit like a virus, its a significant config flaw that leaves the web server and its users vulnerable to various attacks

_The web infrastructure on Port 80 fails to implement industry-standard HTTP security headers, specifically X-Content-Type-Options and Strict-Transport-Security. This configuration lacks basic protection mechanisms (CWE-693) as identified in the scan result, significantly increasing the target's susceptibility to client-side attacks such as Cross-Site Scripting (XSS) and session hijacking via SSL stripping._

This also completes the picture of the target as a Legacy Environment because not only is the software old (Apache 2.4.7), but it lacks the modern security mechanism that protect users today

<img width="1174" height="710" alt="Qualys map" src="https://github.com/user-attachments/assets/1162913b-9a13-4520-87c4-dd653c9f75e2" />

I used the Qualys Mapping tool to visualize the network topology of the target domain and its underlying infrastructure. The map confirms a direct logical link between scanme.nmap.org and the host 45.33.32.156. The scan successfully fingerprinted the asset as an Ubuntu/Linux node, identifying it as a scannable and live target via TCP ports 22 and 80

-------------------------------------------------------
In this phase, I'll conduct a follow-up scan with Nessus to cross-validate the initial findings from Qualys. This multi-tool approach ensures a more comprehensive vulnerability assessment by leveraging different plugin libraries and reducing the likelihood of false positives.

Phase 3: Using nessus tool for vulnerability scan

Process: I initialized the Nessus daemon via the terminal to start the local scanning service. Once the service was active, I transitioned to the Web UI to start the scan and visualize the results in a centralized dashboard.

<img width="1366" height="153" alt="nessus scan terminal" src="https://github.com/user-attachments/assets/e4239cdd-e3c9-4d0a-aac5-e9148a8c3d3e" />

After that, i transitioned to the web UI and i started the Basic Network Scan.

<img width="1366" height="657" alt="nessus result" src="https://github.com/user-attachments/assets/38b88c16-0506-4129-97c8-4696fa385165" />

The screenshot shows the result of the scan. Firsly, i'll access the critical findings

<img width="1366" height="657" alt="nessus vuln_analysis" src="https://github.com/user-attachments/assets/22a0554d-4db7-4283-a742-1993b634f3b9" />

The scan confirms that the target host **45.33.32.156** is running a version of Ubuntu Linux that has been unsupported for over 6 years. This configuration represents a critical security deficiency that could lead to total compromise of the system's integrity and confidentiality  because the server has received zero security patches for over six years. The server is in a dangerous state because it doesn't get official patches anymore. No matter how much we tweak the coniguration, the core security holes will stay open.

This finding explains why i found so many other issues when i used the qualys such as Terrapin(SSH), which exists because the OpenSSH version is too old to have modern protections. The missing headers(HTTP) is there because this Apache version is outdated. It was built before modern security headers became the standard, so it doesn't have the built-in tools to protect users the way newer versions do. Deprecated Ciphers were the standard back in 2014 but are not anymore.

<img width="1366" height="657" alt="nessus ssh1" src="https://github.com/user-attachments/assets/4c4d548c-3bb1-4ade-b6f1-d6f676641a52" />

<img width="1366" height="657" alt="nessus ssh2" src="https://github.com/user-attachments/assets/3c1b8d1b-641d-46a3-9afb-ad3f46ec9d65" />

<img width="1366" height="657" alt="nessuss ssh3" src="https://github.com/user-attachments/assets/b18360d5-945c-41d8-8c8a-e3a78b5f4abf" />

These SSH findings are also in correlation with the scan results in Qualys

To ensure the highest level of accuracy, I cross-validated all findings using a multi-tool approach. My vulnerability assessment followed a progressive discovery workflow. I initiated the phase with Nikto, which immediately flagged the target as an outdated Apache/2.4.7 server and identified critical missing security headers (X-Frame-Options/X-Content-Type-Options). These initial findings were later cross-validated and expanded upon by Qualys and Nessus. This multi-tool approach confirmed that the web vulnerabilities discovered by Nikto are symptoms of a larger systemic issue, the host is running an End-of-Life (SEoL) version of Ubuntu that has not received security updates for over six years 


**Vulnerability Assessment Summary**

| Severity | Vulnerability Name | Target Port | Validated By | Impact |
| :--- | :--- | :--- | :--- | :--- |
| **CRITICAL** | Canonical Ubuntu Linux SEoL (14.04) | System | Nessus / Qualys | **System Compromise:** No security patches since 2019; vulnerable to all post-2019 exploits. |
| **HIGH** | SSH Terrapin Attack (CVE-2023-48795) | 22/tcp | Qualys / Nmap | **Security Downgrade:** Allows MITM/On Path attackers to weaken encryption during handshake. |
| **MEDIUM** | Deprecated SSH Cryptographic Settings | 22/tcp | Nessus / Qualys | **Data Decryption:** Use of CBC and 1024-bit DH keys allows for session hijacking. |
| **MEDIUM** | Missing Security Headers (Clickjacking) | 80/tcp | Nikto / Qualys | **Client-Side Attacks:** Missing X-Frame-Options allows for UI redressing attacks. |
| **INFO** | Information Disclosure (Banner Grabbing) | 80/tcp | Nikto / Wireshark | **Reconnaissance:** Server leaks "Apache/2.4.7" and OS details via HTTP headers. |
